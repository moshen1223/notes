# 二、位置匹配
## 2.1 位置
位置(锚)是相邻字符之间的位置。
## 2.2 位置匹配
ES5中提供6种锚:    
^、$、\b、\B、(?=p)、(?!p)。
### 2.2.1 ^和$
^ 匹配开头，在多行匹配中匹配行开头。    
$ 匹配结尾，在多行匹配中匹配行结尾。    
```
    var str = '"hello"';
    var reg = /^|$/g;
    console.log(str.replace(reg, '#'))  // => #hello#
```
需要注意的是，多行模式匹配时(有修饰符m)
```
    var str = '"Hello\nWorld"';
    var reg = /^|$/gm;
    console.log(str.replace(reg, '#'))  // => 
    #Hello#
    #World#
```
### 2.2.2 \b 和 \B
\b 是单词的边界，具体来说就是\w和\W之间的位置，也包括\w和^之间的位置，和\w和$之间的位置。
```
    var str = '[js] lesson_2.mp4';
    var reg = /\b/g;
    console.log(str.replace(reg, '#'));  // => [#js#] #lesson_2#.#mp4#;
```
说明：\w是字符组[0-9a-zA-Z_]的简写形式，\w是字母数字或者下划线中任何一个字符。\W是排除字符组[^0-9a-zA-Z_]的简写形式，\W是\w以外的任何一个字符。    
第1个，“[”和“j”，是\W和\w之间的位置。    
第2个，“s”和“]”，是\w和\W之间的位置。    
第3个，空格和“l”，是\W和\w之间的位置。    
第4个，2和"."，是\w和\W之间的位置。    
第5个，"."和“m”，是\W和\w之间的位置。    
第6个，4和"$"，是\w和\W之间的位置。    

\B是\b的反面意思，非单词边界。
```
    var str = '[js] lesson_2.mp4';
    var reg = /\B/g;
    console.log(str.replace(reg, '#'));  // => #[j#s]# l#e#s#s#o#n#_#2.m#p#4;
```
说明：\w与\w、\W与\W、^与\W、\W与$之间的位置。
### 2.2.3 （?=p）和（?!p）
(?=p)正向先行断言(positive lookahead)和(?!p)负向先行断言(negative lookahead)。    
(?=p)，其中p是一个子模式，即p前面的位置，或者说该位置后面的字符要匹配p。    
```
    var str = 'hello';
    var reg = /(?=l)/g;
    console.log(str.replace(reg, '#'));  // => he#l#lo
```
(?!p)就是(?=p)的反面意思。
```
    var str = 'hello';
    var reg = /(?!l)/g;
    console.log(str.replace(reg, '#'));  // => #h#ell#o#
```
## 2.3 实例
### 2.3.1 不匹配任何东西的正则
/.^/    
因为此正则要求只有一个字符，但该字符后面是开头，而这样的字符串是不存在的。    
### 2.3.2 数字的千分位分隔符表示法
比如需要将12345678变成12,345,678。     
分析：    
找到相应位置将其变成逗号。  

    1. 找出最后一个逗号：使用(?=\d{3}$)可以实现；其中(?=\d{3}$)匹配\d{3}$前面的位置。而\d{3}$匹配的是目标字符串后面的3位数字。     
    2. 找出所有逗号：因为逗号出现的位置要求后面3个数字一组，也就是\d{3}至少出现一次。     
```
var str = '12345678';
var result = str.replace(/(?=(\d{3})+$)/g,',');
console.log(result) // =>12,345,678
```
这样有一个问题
```
var str = '123456789';
var result = str.replace(/(?=(\d{3})+$)/g,',');
console.log(result) // => ,123,456,789
```
在正则中所表示的是把从结尾向前数，一旦满足3个数就在其前面的位置替换成逗号。    
所以要求匹配的位置不能是开头。匹配开头可以使用^，不匹配开头可以使用(?!^)    
```
var str = '123456789';
var result = str.replace(/(?!^)(?=(\d{3})+$)/g,',');
console.log(result) // => 123,456,789
```
#### 进阶    
把 '1234567 123456789'变成'1,234,567 123,455,789'    
将正则的开头和结尾变成单词边界。 ^->\b, $->\b
```
var str = '1234567 123456789';
var reg = /(?!\b)(?=(\d{3})+\b)/g;
console.log(str.replace(reg, ','))  // => 1,234,567 123,456,789
```
说明：    
    (?!\b) 要求当前是一个位置，但是不能是\b前面的位置，和\B等价。    
#### 应用 
货币格式化
```
// 1888 => $ 1,888.00
function format(num){
    return num.toFixed(2).replace(/\B(?=(\d{3})+\b)/,',').replace(/^/,'$ ')
}
format(1888) // => "$ 1,888.00"
```
### 2.3.3 验证密码
#### 2.3.3.1 方法一
密码要求：密码长度6-12位，由数字、字母组成，必须要包括至少两种字符。  
```  
由简单到复杂
1. 先不考虑至少包含两种字符。    
var reg = /^[0-9A-Za-z]{6,12}$/;      
2. 判断是否包含某一种字符
假设必须包含数字，使用(?=.*[0-9])来做。
var reg = /(?=.*[0-9])^[0-9A-Za-z]{6,12}$/;
重点在(?=.*[0-9])
对于(?=.*[0-9])^来说，分成两部分(?=.*[0-9])和^，表示开头前面还有个位置，(?=.*[0-9])表示位置后面的字符匹配.*[0-9],即，有任何多个任意字符，后面再跟个数字。
3. 同事包含两种字符
假设必须包含数字和小写字母，使用(?=.*[0-9])(?=.*[a-z]) 来做。
var reg = /(?=.*[0-9])(?=.*[a-z])^[0-9a-zA-Z]{6-12}$/;
4. 可能包含的情况：
    同时包含数字和小写字母
    同时包含数字和大写字母
    同时包含小写字母和大写字母
    同时包含数字、小写字母和大写字母
所以之中结果
var reg = /((?=.*[0-9])(?=.*[a-z])|(?=.*[0-9])(?=.*[A-Z])|(?=.*[A-Z])(?=.*[a-z]))^[0-9A-Za-z]{6,12}$/g
```
```
// 验证
var reg = /((?=.*[0-9])(?=.*[a-z])|(?=.*[0-9])(?=.*[A-Z])|(?=.*[A-Z])(?=.*[a-z]))^[0-9A-Za-z]{6,12}$/g;
console.log( reg.test("1234567") ); // false 全是数字
console.log( reg.test("abcdef") ); // false 全是小写字母
console.log( reg.test("ABCDEFGH") ); // false 全是大写字母 console.log( reg.test("ab23C") ); // false 不足6位 console.log( reg.test("ABCDEF234") ); // true 大写字母和数字 console.log( reg.test("abcdEF234") ); // true 三者都有
```
#### 2.3.3.2 方法2
“至少包含两种字符”也就是说不能全是一种字符。    
不能全部是数字： var reg=/(?!^[0-9]{6-12}$)^[0-9a-zA-Z]{6-12}$/;
```
// 验证
var reg = /(?!^[0-9]{6,12}$)(?!^[a-z]{6,12}$)(?!^[A-Z]{6,12}$)^[0-9A-Za-z]{6,12}$/g;
console.log( reg.test("1234567") ); // false 全是数字
console.log( reg.test("abcdef") ); // false 全是小写字母
console.log( reg.test("ABCDEFGH") ); // false 全是大写字母 console.log( reg.test("ab23C") ); // false 不足6位 console.log( reg.test("ABCDEF234") ); // true 大写字母和数字 console.log( reg.test("abcdEF234") ); // true 三者都有
```